<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>kube-prometheus runbooks</title>
    <link>http://localhost:1313/runbooks/systemadmin/</link>
    <description>Recent content on kube-prometheus runbooks</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <atom:link href="http://localhost:1313/runbooks/systemadmin/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title></title>
      <link>http://localhost:1313/runbooks/systemadmin/server-hardening/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/runbooks/systemadmin/server-hardening/</guid>
      <description>&lt;h3 id=&#34;objective&#34;&gt;&#xD;&#xA;  Objective&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#objective&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;p&gt;To provide a comprehensive checklist and set of procedures for securing a newly provisioned Linux server. This runbook ensures a consistent and strong security posture for all servers, minimizing the attack surface.&lt;/p&gt;&#xA;&lt;h3 id=&#34;prerequisites&#34;&gt;&#xD;&#xA;  Prerequisites&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#prerequisites&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Access:&lt;/strong&gt; Root or &lt;code&gt;sudo&lt;/code&gt; access to the target Linux server via SSH.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Knowledge:&lt;/strong&gt; Basic Linux command-line skills and an understanding of networking and security concepts.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Policy:&lt;/strong&gt; Familiarity with your organization&amp;rsquo;s security policies.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;hardening-checklist-and-procedures&#34;&gt;&#xD;&#xA;  Hardening Checklist and Procedures&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#hardening-checklist-and-procedures&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;h4 id=&#34;1-update-the-system&#34;&gt;&#xD;&#xA;  1. Update the System&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#1-update-the-system&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Action:&lt;/strong&gt; Immediately apply all available security patches and updates.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Command (Ubuntu/Debian):&lt;/strong&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt upgrade -y&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Command (CentOS/RHEL):&lt;/strong&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo dnf update -y&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;2-configure-user-access&#34;&gt;&#xD;&#xA;  2. Configure User Access&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#2-configure-user-access&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Action:&lt;/strong&gt; Disable direct root login and create a dedicated administrative user.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Steps:&lt;/strong&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Create a new user: &lt;code&gt;sudo adduser &amp;lt;adminuser&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Add the user to the &lt;code&gt;sudo&lt;/code&gt; group: &lt;code&gt;sudo usermod -aG sudo &amp;lt;adminuser&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Disable root login via SSH. Edit &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PermitRootLogin no&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;Restart the SSH service: &lt;code&gt;sudo systemctl restart sshd&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;3-secure-ssh&#34;&gt;&#xD;&#xA;  3. Secure SSH&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#3-secure-ssh&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Action:&lt;/strong&gt; Harden the SSH configuration to prevent unauthorized access.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Steps:&lt;/strong&gt; Edit &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; and set the following (at a minimum):&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PasswordAuthentication no          # Enforce key-based authentication only&#xD;&#xA;X11Forwarding no                   # Disable X11 forwarding unless needed&#xD;&#xA;AllowUsers &amp;lt;adminuser&amp;gt; &amp;lt;otheruser&amp;gt; # Whitelist allowed SSH users&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Verification:&lt;/strong&gt; After restarting &lt;code&gt;sshd&lt;/code&gt;, ensure you can still log in with your admin user via an SSH key.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;4-configure-a-firewall&#34;&gt;&#xD;&#xA;  4. Configure a Firewall&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#4-configure-a-firewall&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Action:&lt;/strong&gt; Enable and configure a host-based firewall to block all traffic except for necessary services.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tool:&lt;/strong&gt; &lt;code&gt;ufw&lt;/code&gt; (Uncomplicated Firewall) is common on Ubuntu.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Commands:&lt;/strong&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw default deny incoming  &lt;span style=&#34;color:#75715e&#34;&gt;# Deny all incoming traffic by default&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw default allow outgoing &lt;span style=&#34;color:#75715e&#34;&gt;# Allow all outgoing traffic&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw allow ssh              &lt;span style=&#34;color:#75715e&#34;&gt;# Allow SSH (port 22)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw allow http             &lt;span style=&#34;color:#75715e&#34;&gt;# Allow HTTP (port 80) if it&amp;#39;s a web server&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw allow https            &lt;span style=&#34;color:#75715e&#34;&gt;# Allow HTTPS (port 443) if it&amp;#39;s a web server&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo ufw enable                 &lt;span style=&#34;color:#75715e&#34;&gt;# Enable the firewall&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Verification:&lt;/strong&gt; &lt;code&gt;sudo ufw status verbose&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;5-remove-unnecessary-services&#34;&gt;&#xD;&#xA;  5. Remove Unnecessary Services&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#5-remove-unnecessary-services&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Action:&lt;/strong&gt; Reduce the attack surface by uninstalling or disabling any software and services that are not required.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Steps:&lt;/strong&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;List installed packages to identify candidates for removal.&lt;/li&gt;&#xA;&lt;li&gt;List running services: &lt;code&gt;sudo systemctl list-units --type=service --state=running&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Uninstall a package (e.g., &lt;code&gt;telnet&lt;/code&gt; server): &lt;code&gt;sudo apt remove telnetd -y&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Disable a service from starting on boot: &lt;code&gt;sudo systemctl disable &amp;lt;service-name&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;6-install-security-tools&#34;&gt;&#xD;&#xA;  6. Install Security Tools&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#6-install-security-tools&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h4&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Action:&lt;/strong&gt; Install tools for intrusion detection and monitoring.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Recommendations:&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fail2Ban:&lt;/strong&gt; Monitors logs for malicious activity (like brute-force login attempts) and temporarily bans offending IPs.&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install fail2ban -y&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Default configuration is usually sufficient to start.&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Auditd:&lt;/strong&gt; The Linux Auditing System provides detailed logging of security-relevant events.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;verification&#34;&gt;&#xD;&#xA;  Verification&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#verification&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Perform a port scan of the server from an external machine (e.g., using &lt;code&gt;nmap&lt;/code&gt;) to confirm that only expected ports are open.&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nmap -sT -p- &amp;lt;server-ip&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;Attempt to log in as &lt;code&gt;root&lt;/code&gt; via SSH and confirm it is denied.&lt;/li&gt;&#xA;&lt;li&gt;Attempt to log in with a password for your admin user and confirm it is denied (if key-only auth was enforced).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;rollback-plan&#34;&gt;&#xD;&#xA;  Rollback Plan&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#rollback-plan&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If a hardening step locks you out (e.g., incorrect firewall rule), you will need console access (physical or via your cloud provider&amp;rsquo;s console) to log in and revert the change.&lt;/li&gt;&#xA;&lt;li&gt;Always apply firewall and SSH changes with an active console session open as a backup.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;escalation&#34;&gt;&#xD;&#xA;  Escalation&#xD;&#xA;  &#xD;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#escalation&#34;&gt;#&lt;/a&gt;&#xD;&#xA;  &#xD;&#xA;&lt;/h3&gt;&#xD;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Who:&lt;/strong&gt; Senior System Administrator or Security Team.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;When:&lt;/strong&gt; If you are unsure about the impact of a specific hardening setting or if you suspect a security compromise during the provisioning process.&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
  </channel>
</rss>
